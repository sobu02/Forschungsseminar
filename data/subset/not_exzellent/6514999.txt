Stichprobenkovarianz
Die Stichprobenkovarianz oder empirische Kovarianz (oft auch einfach Kovarianz (von con- = „mit-“ und Varianz von variare = „(ver)ändern, verschieden sein“)) ist in der Statistik eine nichtstandardisierte Maßzahl für den (linearen) Zusammenhang zweier statistischer Variablen. Die korrigierte Stichprobenkovarianz ist eine erwartungstreue Schätzung der Kovarianz einer Grundgesamtheit mittels einer Stichprobe. Ist die Kovarianz positiv, dann gehen kleine Werte der einen Variable überwiegend einher mit kleinen Werten der anderen Variable und gleichfalls für große Werte. Für eine negative Kovarianz ist das genau umgekehrt. == Definition == Ist (x_1, y_1),...,(x_n, y_n) eine Datenreihe (Stichprobe) zweier statistischer Variablen X und Y, dann ist die Stichprobenkovarianz definiert als „durchschnittliches Abweichungsprodukt“ :s_{xy}:= \tfrac1n SP_{xy} = \frac1n \sum_{i=1}^n (x_i -\bar{x})(y_i-\bar{y}) mit den arithmetischen Mitteln \textstyle \bar{x}=\frac 1n \sum_{i=1}^n x_i und \textstyle \bar{y}=\frac 1n \sum_{i=1}^n y_i der Datenreihen (x_1,...,x_n) und (y_1,...,y_n). Die Stichprobenkovarianz misst die gemeinsame Streuung („Mitstreuung“) der Beobachtungsdaten einer Stichprobe. Dabei wird die mittlere Abweichung der Beobachtungsdaten von den Mittelwerten (\bar{x},\bar{y}) berechnet. == Korrigierte Stichprobenkovarianz == Um aus einer Stichprobe eine Schätzung der unbekannten Kovarianz \sigma_{xy} der Grundgesamtheit zu erhalten wird die korrigierte Stichprobenkovarianz genutzt: :\hat{\sigma}_{xy} = \frac{1}{n-1}\sum_{i=1}^n{(x_i-\bar{x}) (y_i-\bar{y})} Bei einer einfachen Zufallsstichprobe haben die Stichprobenvariablen X_i und Y_i die Kovarianz \operatorname{Cov}(X_i,Y_i)=\sigma_{xy}. Unter Annahme einer zweidimensionalen Normalverteilung der Stichprobenvariablen (X_i,Y_i) und mit Hilfe der Maximum- Likelihood-Methode ergibt sich die Schätzfunktion :S_{XY} = \frac{1}{n}\sum_{i=1}^n (X_i-\bar{X})(Y_i-\bar{Y}). Es stellt sich jedoch heraus, dass der Erwartungswert \operatorname{E}(S_{XY})= \tfrac{n-1}{n}\sigma_{xy} ist, d. h. die Schätzfunktion S_{XY} ist nicht erwartungstreu (also verzerrt) für \sigma_{xy}. Die korrigierte Stichprobenkovarianz ist jedoch unverzerrt. Im Rahmen der induktiven Statistik wird daher immer die korrigierte Stichprobenkovarianz verwendet. == Auswahl der Berechnungsformel == Der Kovarianz \sigma_{xy} kann, gemäß ihrer Definition, mit der Gleichung :\sigma_{xy} = \tfrac1n \sum_{i=1}^n\left(x_i-\bar{x}\right)\left(y_i-\bar{y}\right) aus einer Datenreihe berechnet werden. Diese Formel wird verwendet, wenn die Werte x_i und y_i einen vollständigen Datensatz beschreiben und die wahren Mittelwerte \bar{x} und \bar{y} der beiden Zufallsvariablen bekannt oder ausreichend bekannt sind. Oft liegt jedoch nur eine Stichprobe mit einer reduzierten Anzahl von Messwerten vor, mit denen die Kovarianz nur geschätzt werden kann. Wenn dabei die Mittelwerte aus dem arithmetischen Mittel gebildet werden, liefert die obige Formel systematisch zu kleine Werte. Daher verwendet man insbesondere bei sehr wenigen Messwerten die Formel der korrigierten Stichprobenkovarianz :\sigma_{xy} \approx \tfrac1{n-1} \sum_{i=1}^n \left(x_i-\bar{x}\right)\left(y_i-\bar{y}\right) welche die Kovarianz zumindest erwartungstreu schätzt. In manchen Fällen sind einzelne Messwerte der Stichprobe unterschiedlich über- oder unterrepräsentiert oder die Messwerte haben unterschiedliche Auftrittswahrscheinlichkeiten. In einem solchen Fall kann mit der erweiterten Formel :\sigma_{xy} \approx \tfrac1W \sum_i w_i\left(x_i-\bar{x}\right)\left(y_i-\bar{y}\right) jedem Messwert zum Ausgleich ein individuelles Gewicht w_i zugeordnet werden. Wenn die Gewichte zur Korrektur von relativen Häufigkeiten verwendet werden, dann ist die erwartungstreue Normierung :\tfrac1W = \frac1{-1+\sum_i w_i} zu verwenden. Bei Gewichten, die eine Wahrscheinlichkeit angeben, mit der das Wertepaar in einer Stichprobe zu finden ist, muss dagegen mit :\tfrac1W = \frac{\sum_i w_i}{\left(\sum_i w_i\right)^2-\sum_i w_i^2} normiert werden. Die Mittelwerte \bar{x} und \bar{y} werden dabei mit den jeweiligen Gewichten gebildet: :\bar{x} = \frac{\sum_i w_i x_i}{\sum_i w_i}, \bar{y} = \frac{\sum_i w_i y_i}{\sum_i w_i}. == Eigenschaften == → Siehe auch: Kovarianz (Stochastik)#Eigenschaften und Rechenregeln === Beziehung zur Varianz === Die Kovarianz ist eine Erweiterung der Varianz, denn es gilt :*s'^2=s_{xx} bzw. :*s^2=\hat{\sigma}_{xx}. Dabei ist s'^2 und s^2 die empirischen Varianzen mit passendem Vorfaktor. Das heißt, die Varianz ist die Kovarianz einer Variable mit sich selbst. === Verschiebungssatz === Der Verschiebungssatz liefert eine alternative Darstellung der Kovarianz :*s_{xy}=\frac{1}{n} \left( \sum_{i=1}^n {(x_i y_i) - n\bar{x}\bar{y}} \right)=\left(\frac{1}{n}\sum_{i=1}^n x_i y_i\right)-\bar{x}\bar{y}. :*\hat{\sigma}_{xy} = \frac{1}{n-1} \left( \sum_{i=1}^n {(x_i y_i) - n\bar{x}\bar{y}} \right). Diese Formeln ermöglichen in vielen Fällen eine einfachere Berechnung der Kovarianz. Bei numerischer Rechnung muss dabei allerdings auf unerwünschte Stellenauslöschung bei der Subtraktion großer Zahlen geachtet werden. === Symmetrie und Linearität === Die Kovarianz ist linear und symmetrisch, d. h. es gilt: ;Symmetrie :Beim Vertauschen der Rollen von x_i und y_i ergibt sich der gleiche Wert für die Kovarianz: :*s_{xy}=s_{yx} bzw. :*\hat{\sigma}_{xy}=\hat{\sigma}_{yx} ;Linearität :Wird eine der Variablen einer linearen Transformation unterzogen, z. B. u_i=a+b \cdot x_i, so gilt :*s_{uy}=b s_{xy} bzw. :*\hat{\sigma}_{uy}=b\hat{\sigma}_{yx} :Wegen der Symmetrie ist die Kovarianz auch im zweiten Argument linear. Die Linearität der Kovarianz hat zur Folge, dass die Kovarianz von der Maßeinheit der Variablen abhängt. So erhält man beispielsweise die zehnfache Kovarianz, wenn man anstatt X die Variable 10 X betrachtet. Da diese Eigenschaft die absoluten Werte der Kovarianz schwer interpretierbar macht, betrachtet man häufig stattdessen den maßstabsunabhängigen Korrelationskoeffizienten. == Beispiele == === Beispiel 1 === Die folgende Grafik zeigt für 21 verschiedene Datensätze jeweils das Streudiagramm zusammen mit der Kovarianz s_{xy} und der Korrelation r_{xy} des Datensatzes. Die erste Reihe zeigt sieben Datensätze mit unterschiedlich starkem linearen Zusammenhang, wobei die Korrelation r_{xy} von +1 über 0 nach −1 geht. Da die Kovarianz ein nicht-standardisiertes Maß ist, geht sie von +2 auf Null bis auf −2. D.h., wenn es keinen linearen Zusammenhang gibt, dann ist die Kovarianz genauso Null wie die Korrelation. Das Vorzeichen der Kovarianz zeigt die Richtung des Zusammenhangs an; jedoch zeigt sie nicht die Stärke des Zusammenhangs. Noch deutlicher wird es in der zweiten Zeile, wo alle sieben Datensätze einen perfekten linearen Zusammenhang haben. Doch die Kovarianz s_{xy} nimmt ab auf Null und wird dann negativ. Die Korrelation r_{xy} ist für diese Datensätze entweder +1 oder −1 (bzw. undefiniert). Die dritte Zeile zeigt schließlich, dass sowohl die Kovarianz als auch die Korrelation Null ist, obwohl ein deutlicher Zusammenhang zwischen beiden Variablen sichtbar ist. D.h. die Kovarianz misst nur den linearen Zusammenhang und nicht-lineare Zusammenhänge werden nicht erkannt. 640px|zentriert|Kovarianz s_{xy} und Korrelation r_{xy} für unterschiedliche Datensätze. === Beispiel 2 === In einer Schule soll überprüft werden, ob es einen Zusammenhang gibt zwischen der Anzahl der unterrichteten Stunden der Lehrer am Tag und der Anzahl der getrunkenen Tassen Kaffee. Es wurden zehn Datenpaare erhoben und ausgewertet (so nicht durchgeführt, nur der Anschauung halber!): {| class="wikitable" |- | Nummer || 1 || 2 || 3 || 4 || 5 || 6 || 7 || 8 || 9 || 10 |- | Anzahl Stunden (x_i) || 5 || 6 || 8 || 4 || 6 || 6 || 5 || 7 || 5 || 4 |- | Anzahl Tassen (y_i)|| 2 || 1 || 4 || 1 || 2 || 0 || 2 || 3 || 3 || 1 |} Die Kovarianz wird nun folgendermaßen berechnet: a.) Zunächst wird das arithmetische Mittel beider Variablen ermittelt: \textstyle \bar{x}=\frac 1n \sum_{i=1}^n x_i = \frac {(5+6+8+4+6+6+5+7+5+4)} {10} = 5{,}6 und \textstyle \bar{y}=\frac 1n \sum_{i=1}^n y_i = \frac {(2+1+4+1+2+0+2+3+3+1)} {10} = 1{,}9 b.) Die Kovarianz wird nun berechnet über: s_{xy}:=\frac1n \sum_{i=1}^n (x_i -\bar{x})(y_i-\bar{y}) := \tfrac{(5-5{,}6)(2-1{,}9)+(6-5{,}6)(1-1{,}9)+(8-5{,}6)(4-1{,}9)+(4-5{,}6)(1-1{,}9)+(6-5{,}6)(2-1{,}9)+(6-5{,}6)(0-1{,}9)+(5-5{,}6)(2-1{,}9)+(7-5{,}6)(3-1{,}9)+(5-5{,}6)(3-1{,}9)+(4-5{,}6)(1-1{,}9)}{10} := 0{,}76 Da die Kovarianz größer als null ist, ist für diese Stichprobe ein positiver Zusammenhang zwischen der Anzahl der Unterrichtsstunden und der Anzahl der Tassen Kaffee ersichtlich. Ob dies auf die Grundgesamtheit, hier das Lehrerkollegium, generalisierbar ist, hängt von der Qualität der Stichprobe ab. == Stichproben-Kovarianzmatrix == Eine Schätzung der Kovarianzmatrix in der Grundgesamtheit \widehat{\mathbf{\Sigma}} erhält man, indem man die Varianzen und Kovarianzen in der Grundgesamtheit \operatorname{Var}(X_i) = \sigma^2_i und \operatorname{Cov}(X_i,X_j) = \sigma_{ij}\;,i e j durch die empirischen Varianzen und empirischen Kovarianzen (ihre empirischen Gegenstücke) \hat\sigma^2_{j} = s_j^2 und \hat\sigma_{jk} = s_{jk} ersetzt (sofern die x-Variablen Zufallsvariablen darstellen schätzen die die Parameter in der Grundgesamtheit). Diese sind gegeben durchLudwig Fahrmeir, Thomas Kneib, Stefan Lang, Brian Marx: Regression: models, methods and applications. Springer Science & Business Media, 2013, ISBN 978-3-642-34332-2, S. 648.Rencher, Alvin C., und G. Bruce Schaalje: Linear models in statistics., John Wiley & Sons, 2008., S. 156. :\hat\sigma^2_{j} = s_{j}^2 := \frac{1}{n-1} \sum \limits_{i=1}^n\left(x_{ij}-\overline x_{j}\right)^2\; und \;\hat\sigma_{jk} = s_{jk} := \frac{1}{n-1} \sum_{i=1}^n (x_{ij} -\overline{x}_{j})(x_{ik}-\overline{x}_{k}). Dies führt zur Stichproben- Kovarianzmatrix \mathbf{S}: :\begin{align} \mathbf{S} = \widehat{\mathbf{\Sigma}} = \widehat{\operatorname{Cov}(\mathbf{X})} & = \begin{pmatrix} s^2_{1} & s_{12} & \cdots & s_{1k} \\\ \\\ s_{21} & s^2_{2} & \cdots & s_{2k}\\\ \\\ \vdots & \vdots & \ddots & \vdots \\\ \\\ s_{k1} & s_{k2} & \cdots & s^2_{k} \end{pmatrix}\end{align}. Zum Beispiel sind s^2_{2} und s_{12} gegeben durch :\hat\sigma^2_{2} = s_{2}^2 := \frac{1}{n-1} \sum \limits_{i=1}^n\left(x_{i2}-\overline x_{2}\right)^2\; und \;\hat\sigma_{12} = s_{12} := \frac{1}{n-1} \sum_{i=1}^n (x_{i1} -\overline{x}_{1})(x_{i2}-\overline{x}_{2}), mit dem arithmetischen Mittel : \overline{x}_{2} := \frac1n \sum_{i=1}^n{x_{i2}}. === Beispiel === Bei 10 Datenpunkten seien jeweils die Werte x_1 und x_2 gemessen worden: mini {| class="wikitable" |+ Messwerte |- ! x_1 !! x_2 |- | 1,0 || 1,41 |- | 2,0 || 1,56 |- | 2,0 || 2,19 |- | 4,0 || 2,79 |- | 5,0 || 3,04 |- | 6,0 || 2,23 |- | 9,0 || 3,74 |- | 9,0 || 3,84 |- | 9,0 || 2,80 |- | 13,0 || 4,18 |} Die Berechnung des geschätzten Mittelwertes ergibt: \hat{\mu}_1 = 6, \hat{\mu}_2 = 2{,}78, \hat{\sigma}_1 = 13{,}8 ; \hat{\sigma}_2 = 0{,}81, \hat{\text{cov}}_{1,2} = 2{,}972. Daher ist die Stichprobenkovarianzmatrix C=\begin{pmatrix}13{,}8 & 2{,}972 \\\2{,}972 & 0{,}81\end{pmatrix}. In Bezug auf den Mittelpunkt (\hat{\mu}_1, \hat{\mu}_2) der Punktwolke kann im Diagramm eine Konzentrationsellipse eingezeichnet werden. Die Punkte auf dem Rand der Ellipse sind also durch folgende Menge gegeben: \lbrace (x_1,x_2)C^{-1}\begin{pmatrix}x_1\\\x_2\end{pmatrix}=k^2 \rbrace. == Siehe auch == * Kovarianzmatrix == Einzelnachweise == Kategorie:Deskriptive Statistik 